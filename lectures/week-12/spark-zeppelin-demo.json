{"paragraphs":[{"text":"%pyspark\ntrips = sc.textFile(\"s3://dchud-demo/201*.csv.gz\")\nheader = trips.first()\ntrips = trips.filter(lambda line: line != header) \\\n    .map(lambda line: line.split(',')) \\\n    .cache()","dateUpdated":"2016-11-30T02:11:39+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109241_850675288","id":"20161129-035221_115626044","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-30T01:58:29+0000","dateStarted":"2016-11-30T02:11:40+0000","dateFinished":"2016-11-30T02:11:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:220"},{"text":"%pyspark\ntrips.count()","dateUpdated":"2016-11-30T01:59:36+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109243_851444786","id":"20161129-035323_1148064022","result":{"code":"SUCCESS","type":"TEXT","msg":"3257103\n"},"dateCreated":"2016-11-30T01:58:29+0000","dateStarted":"2016-11-30T01:59:36+0000","dateFinished":"2016-11-30T02:00:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:221"},{"text":"%pyspark\ntrips.take(1)","dateUpdated":"2016-11-30T01:58:29+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109243_851444786","id":"20161129-035328_1346958587","result":{"code":"SUCCESS","type":"TEXT","msg":"[[u'257866', u'7/1/2015 0:00', u'7/1/2015 0:04', u'31116', u'California St & Florida Ave NW', u'31117', u'15th & Euclid St  NW', u'W21516', u'Registered']]\n"},"dateCreated":"2016-11-30T01:58:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:222"},{"text":"%pyspark\npopular = trips.filter(lambda row: row[4] == 'Eastern Market / 7th & North Carolina Ave SE') \\\n    .map(lambda row: (row[6], 1)) \\\n    .reduceByKey(lambda a, b: a + b) \\\n    .takeOrdered(25, lambda row: -row[1])\nfor dest, c in popular: print(c, dest)","dateUpdated":"2016-11-30T01:58:29+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109244_849521041","id":"20161129-035656_1819335512","result":{"code":"SUCCESS","type":"TEXT","msg":"(849, u'Lincoln Park / 13th & East Capitol St NE ')\n(603, u'Columbus Circle / Union Station')\n(563, u'13th & D St NE')\n(527, u'D St & Maryland Ave NE')\n(516, u'14th & D St SE')\n(516, u'4th & East Capitol St NE')\n(482, u'15th St & Massachusetts Ave SE')\n(445, u'15th & East Capitol St NE')\n(412, u'6th & H St NE')\n(404, u'3rd St & Pennsylvania Ave SE')\n(373, u'3rd & D St SE')\n(328, u'3rd & G St SE')\n(324, u'3rd & H St NE')\n(279, u'3rd & Tingey St SE')\n(276, u'Potomac & Pennsylvania Ave SE')\n(270, u'1st & K St SE')\n(262, u'8th & F St NE')\n(261, u'Washington & Independence Ave SW/HHS')\n(260, u'Eastern Market / 7th & North Carolina Ave SE')\n(249, u'13th & H St NE')\n(228, u'Maryland & Independence Ave SW')\n(219, u'11th & H St NE')\n(209, u'Eastern Market Metro / Pennsylvania Ave & 7th St SE')\n(206, u'19th & East Capitol St SE')\n(192, u'8th & East Capitol St NE')\n"},"dateCreated":"2016-11-30T01:58:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:223"},{"text":"%pyspark\nd = sqlContext.read.load(\"s3://dchud-demo/201*.csv.gz\", format=\"csv\", header='true', inferSchema='true')","dateUpdated":"2016-11-30T02:01:31+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109244_849521041","id":"20161129-035734_1553681951","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-30T01:58:29+0000","dateStarted":"2016-11-30T02:01:32+0000","dateFinished":"2016-11-30T02:01:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:224"},{"text":"%pyspark\nd.dtypes","dateUpdated":"2016-11-30T01:58:29+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109245_849136292","id":"20161129-044702_1997113060","result":{"code":"SUCCESS","type":"TEXT","msg":"[('Duration (ms)', 'string'), ('Start date', 'string'), ('End date', 'string'), ('Start station number', 'string'), ('Start station', 'string'), ('End station number', 'string'), ('End station', 'string'), ('Bike #', 'string'), ('Member type', 'string')]\n"},"dateCreated":"2016-11-30T01:58:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:225"},{"text":"%pyspark\nd.createOrReplaceTempView(\"rides\")\ncount = sqlContext.sql(\"\"\"\n    SELECT AVG(`Duration (ms)`) / (60 * 1000) AS avg_min, `End Station` AS end_station\n    FROM rides\n    WHERE `Start Station` LIKE 'Columbus Circle%'\n    GROUP BY `Start Station`, `End Station`\n    HAVING COUNT(*) > 20\n    ORDER BY avg_min DESC\n    LIMIT 10\n    \"\"\")\ncount.collect()","dateUpdated":"2016-11-30T02:04:31+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"graph":{"mode":"table","height":91,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109245_849136292","id":"20161129-045043_1887036184","result":{"code":"SUCCESS","type":"TEXT","msg":"[Row(avg_min=77.07568690476191, end_station=u'Kennedy Center'), Row(avg_min=67.52393277777777, end_station=u'34th & Water St NW'), Row(avg_min=57.03273958333333, end_station=u'37th & O St NW / Georgetown University'), Row(avg_min=56.80704, end_station=u'C & O Canal & Wisconsin Ave NW'), Row(avg_min=56.319562121212115, end_station=u'Columbus Circle / Union Station'), Row(avg_min=56.05042723577236, end_station=u'Connecticut & Nebraska Ave NW'), Row(avg_min=49.595460370370375, end_station=u'23rd & E St NW '), Row(avg_min=48.36411142222222, end_station=u'Lincoln Memorial'), Row(avg_min=46.9488095505618, end_station=u'Georgetown Harbor / 30th St NW'), Row(avg_min=43.27357276422764, end_station=u'Ohio Dr & West Basin Dr SW / MLK & FDR Memorials')]\n"},"dateCreated":"2016-11-30T01:58:29+0000","dateStarted":"2016-11-30T02:04:31+0000","dateFinished":"2016-11-30T02:04:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:226"},{"text":"%sql\nSELECT `End Station`, COUNT(*)\nFROM rides\nWHERE `Start Station` LIKE 'Columbus Circle%'\nGROUP BY `End Station`\nORDER BY COUNT(*) DESC\nLIMIT 10","dateUpdated":"2016-11-30T01:58:29+0000","config":{"tableHide":false,"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"graph":{"mode":"lineChart","height":300,"optionOpen":false,"keys":[{"name":"End Station","index":0,"aggr":"sum"}],"values":[{"name":"count(1)","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"End Station","index":0,"aggr":"sum"}},"forceY":true,"lineWithFocus":false},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109246_850290539","id":"20161129-045705_928055727","result":{"code":"SUCCESS","type":"TABLE","msg":"End Station\tcount(1)\n8th & F St NE\t4753\n6th & H St NE\t2898\n11th & H St NE\t2737\n3rd & H St NE\t2346\n13th & D St NE\t2260\n13th & H St NE\t2189\n15th & F St NE\t2138\nUSDA / 12th & Independence Ave SW\t1928\nD St & Maryland Ave NE\t1855\nM St & New Jersey Ave SE\t1849\n","comment":"","msgTable":[[{"key":"count(1)","value":"8th & F St NE"},{"key":"count(1)","value":"4753"}],[{"value":"6th & H St NE"},{"value":"2898"}],[{"value":"11th & H St NE"},{"value":"2737"}],[{"value":"3rd & H St NE"},{"value":"2346"}],[{"value":"13th & D St NE"},{"value":"2260"}],[{"value":"13th & H St NE"},{"value":"2189"}],[{"value":"15th & F St NE"},{"value":"2138"}],[{"value":"USDA / 12th & Independence Ave SW"},{"value":"1928"}],[{"value":"D St & Maryland Ave NE"},{"value":"1855"}],[{"value":"M St & New Jersey Ave SE"},{"value":"1849"}]],"columnNames":[{"name":"End Station","index":0,"aggr":"sum"},{"name":"count(1)","index":1,"aggr":"sum"}],"rows":[["8th & F St NE","4753"],["6th & H St NE","2898"],["11th & H St NE","2737"],["3rd & H St NE","2346"],["13th & D St NE","2260"],["13th & H St NE","2189"],["15th & F St NE","2138"],["USDA / 12th & Independence Ave SW","1928"],["D St & Maryland Ave NE","1855"],["M St & New Jersey Ave SE","1849"]]},"dateCreated":"2016-11-30T01:58:29+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:227"},{"text":"%pyspark\ncount.write.save(\"s3://dchud-demo/avgduration-end.parquet\")","dateUpdated":"2016-11-30T02:04:37+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471109247_849905790","id":"20161129-051116_1110059880","result":{"code":"SUCCESS","type":"TEXT","msg":""},"dateCreated":"2016-11-30T01:58:29+0000","dateStarted":"2016-11-30T02:04:37+0000","dateFinished":"2016-11-30T02:04:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:228"},{"text":"","dateUpdated":"2016-11-30T02:01:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480471286115_1093930182","id":"20161130-020126_600066919","dateCreated":"2016-11-30T02:01:26+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:229"}],"name":"dchud","id":"2C49FER1T","angularObjects":{"2BRWU4WXC:shared_process":[],"2AM1YV5CU:shared_process":[],"2AJXGMUUJ:shared_process":[],"2ANGGHHMQ:shared_process":[],"2AKK3QQXU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}